# File Upload Vulnerability

Many web-applications allow you to upload files to the webserver, such as photos, PDFs, text files, and so on. If we do not handle the files properly, they may pose a threat to the webserver.. An attacker can submit the typical filename via a POST data request furthermore, attacker can Execute the script on website and gain the access.  <br><br>

To perform the exploitation, the user just uploads the web shell to the server directly or via several bypass methods that enable remote code execution. Backtrack contains several web shells for various technologies such as PHP, ASP, and others. The intensity of an attack might range from gaining reverse shells to gaining entire system control. .<br>

# Ways to prevent it:
<b>A web application should include :</b>
1. Before uploading it to the server, look for potentially dangerous file extensions such as.asp,.php, and so on. .<br>
2. Look for files with two extensions, such as shell1.png.php. .<br>
3. Before uploading files to the server, rename them. .<br>
4. alter the upload folder's permissions so that the contents within it are not executable .<br>

# Let's try it!

Lets exploiting a file upload vulnerability ?

To follow up with the article make sure you are equipped with DVWA Broken Web Applications project. (If you don't have how to setup a Vulnerable web server <a href='https://www.kalilinux.in/2020/01/setup-dvwa-kali-linux.html'>this</a> guide can help you )

1.  Make sure the OWASP BWA is running then head over to it's webpage. Then click the encircled link to go to the bricks webpage.
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/images/brick.PNG)

2.  After that click the encircled option under 'Bricks' menu
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/images/brick2.png)

3.  Click the first option to proceed to the file upload page
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/images/1.PNG)

4.  Now we can easily upload our code to the web server.<br>
    So we will be uploading a php file <code>php-backdoor.php</code>(present in the repository) to obtain a webshell to the server. This file is extracted from Kali Linux     and can be found in <i>/usr/share/webshells/php</i> folder. You can also use other codes present there also but for the sake of this         article let's just stick to <b>php-backdoor.php</b>

    Now from choose file option upload the php-backdoor.php file to the web app. 
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/images/upload.PNG)

5.  Click on 'here' that appears in the success prompt and you will be directed to the webshell.
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/images/terminal.PNG)

6.  It's all yours now! you just gained access to a webserver without much pain. Try plaing around a little bit, try typing 'ls' in the execute command textbox and click the go button.
![](https://github.com/VH-Tech/Unrestricted-File-Upload-Vulnerability/blob/master/images/go.PNG)

7. Well you will see that it only shows our file php-backdoor.php in output. That's because we are using OWASP BWA which is purposely      meant for practice of hackers and so it doesn't contain any data but who knows what you might find in some other webapp. :P


<h3>Please try this on your personal devices only. It's not a good practice to hack others property :)</h3>

